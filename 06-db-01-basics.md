# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.


## Ответ

Электронные чеки в json виде

*Так как чек - это агрегированная модель в json виде, я думаю здесь подойдет самый яркий представитель NoSQL - MongoDB.*

Склады и автомобильные дороги для логистической компании

*Если взглянуть на карту дорог сверху мы можем увидеть, что лучшим решением для логистической компании будут БД с реализацией сетевой модели в виде графа.*

Генеалогические деревья

*Иерархический тип, если не требуется хранения информации о пересекающемся родстве (Свояк, дядя, тетя), если же данная информация требуется, то подойдет БД графового типа.*

Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации

*Здесь подойдет БД типа ключ-значения с функцией Time-To-Live Redis или Memcashed.*

Отношения клиент-покупка для интернет-магазина

*NoSQL типа ключ-значение, где ключ это клиент(например email при регистрации на сайте магазина) и значение его покупки.* 

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

## Ответ

Данные записываются на все узлы с задержкой до часа (асинхронная запись)

*AP, PA/EL*

При сетевых сбоях, система может разделиться на 2 раздельных кластера

*CA, PA/EC*

Система может не прислать корректный ответ или сбросить соединение

*CP, PC/EC*

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

## Ответ

 *Нет, не могут. 
Базы данных BASE имеют в отношении согласованности только одно требование, чтобы в какой-то момент в будущем данные конвергировались в согласованное состояние. Однако никаких гарантий относительно того, когда это произойдет, не дается. Это полное отклонение от требования немедленной согласованности ACID, которое запрещает выполнение транзакции до тех пор, пока предыдущая транзакция не будет завершена и база данных не приблизится к согласованному состоянию.*



## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?


## Ответ

*Это СУБД Redis,которая реализует классический pub-sub и показывает замечательную производительность.
Можно установить Redis локально или как распределенный сервис или добавить возможность сохранения сообщений на диск.*

*Минусы данной БД:*

  *Размер БД ограничен доступной памятью*
  
  *Шардинг (техника масштабирования) ведет к увеличению задержки*
  
  *Отсутствует возможность использовать язык SQL*
  
  *Нет сегментации на пользователей или группы пользователей. Отсутствует контроль доступа*



